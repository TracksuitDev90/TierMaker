/* ---------- Reset ---------- */
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{height:100%}
body{
  margin:0;
  font:16px/1.45 ui-sans-serif,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
  -webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;
  color:var(--text); background:var(--surface); overscroll-behavior:none;
}
img{max-width:100%;display:block}
button{font:inherit;color:inherit;background:none;border:0;cursor:pointer}
input,textarea{font:inherit;color:inherit}
:focus-visible{outline:2px solid transparent;box-shadow:0 0 0 3px rgba(139,125,255,.45);border-radius:8px}
a{color:inherit;text-decoration:none}

/* ---------- Theme ---------- */
:root{
  --surface:#0f1115; --surface-raised:#171a22; --card:#11141c;
  --text:#e8eaf0; --muted:#a7b0c0; --border:rgba(255,255,255,.08);
  --shadow:0 10px 28px rgba(0,0,0,.35);
  --accent:#8b7dff; --brand:var(--neon); --neon:#d8ff3f;
}
:root[data-theme="light"]{
  --surface:#f7f8fb; --surface-raised:#fff; --card:#f0f3f8;
  --text:#0f1222; --muted:#465062; --border:rgba(10,10,20,.08);
  --shadow:0 10px 24px rgba(0,0,0,.08);
  --accent:#6b5fff; --brand:#000; --neon:#c8ff45;
}

/* ---------- Layout ---------- */
.wrap{max-width:1200px;margin:0 auto;padding:clamp(16px,2.4vw,28px)}
.header{display:flex;align-items:center;gap:14px;margin-bottom:14px}
.brand{font-weight:1000;letter-spacing:1px;color:var(--brand);font-size:clamp(28px,5.2vw,48px);position:sticky;top:14px;z-index:20}
@media (max-width:1024px){.brand{position:static}}

.panel{
  background:var(--surface-raised); border:1px solid var(--border); border-radius:14px;
  box-shadow:var(--shadow); padding:clamp(14px,1.8vw,18px); margin-bottom:16px; overflow:visible;
}
.section-title{font-size:clamp(18px,2vw,24px);font-weight:900;margin:0 0 14px}

/* ---------- Controls ---------- */
.controls{display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:14px}
@media (max-width:720px){.controls{grid-template-columns:1fr 1fr}}
.btn{
  display:inline-flex;align-items:center;justify-content:center;gap:10px;height:56px;padding:0 18px;border-radius:16px;
  background:var(--surface);color:var(--text);border:1px solid var(--border);box-shadow:var(--shadow);
  transition:transform .08s ease,background .2s ease,border-color .2s ease,filter .2s ease;
}
.btn:hover{transform:translateY(-1px)}
.btn:active{transform:translateY(0);filter:brightness(.98)}
.btn .ico{width:22px;height:22px;display:grid;place-items:center}
.btn .ico svg{width:22px;height:22px;fill:currentColor}
.btn-accent{background:#8b7dff;color:#fff;border-color:rgba(255,255,255,.15)}
.btn-danger{background:#ff6b6b;color:#fff;border-color:rgba(255,255,255,.18)}
.btn-success{background:#22c55e;color:#0a1b12;border-color:rgba(0,0,0,.08)}
.btn.small{height:42px;padding:0 12px;border-radius:12px;font-weight:700}

/* ---------- Creator ---------- */
.creator-grid{display:grid;gap:12px}
.creator-line{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.input{flex:1 1 260px;height:48px;padding:0 14px;background:var(--card);color:var(--text);border:1px solid var(--border);border-radius:12px}
.color-dot{width:40px;height:40px;border-radius:999px;border:3px solid var(--surface-raised);box-shadow:0 4px 18px rgba(0,0,0,.25) inset,0 2px 8px rgba(0,0,0,.2)}
.help{color:var(--muted);font-weight:600;margin-top:10px}
.help strong{color:var(--accent)} /* stands out in both themes */

/* ---------- Board ---------- */
.board-title-wrap{display:flex;align-items:center;gap:8px;margin:0 0 10px}
.title-pen svg{width:18px;height:18px;fill:currentColor;opacity:.55}
.board-title{font-size:clamp(20px,2.2vw,28px);font-weight:900;margin:0}
.board-title[contenteditable]:empty::before{content:'Tier Board (optional title)';color:var(--muted)}

#tierBoard{display:grid;gap:12px}
.tier-row{display:grid;grid-template-columns:160px 1fr;gap:12px;align-items:stretch;overflow:visible}
@media (max-width:768px){.tier-row{grid-template-columns:120px 1fr}}

.tier-label{
  position:relative;background:linear-gradient(180deg,rgba(255,255,255,.05),rgba(0,0,0,.05));
  border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow);
  padding:10px;display:grid;place-items:center;min-height:110px;overflow:visible;
}
.label-chip{
  position:relative;
  width:100%;height:86px;border-radius:12px;background:#ff6b6b;color:#111;
  display:flex;align-items:center;justify-content:center;
  font-weight:900;font-size:clamp(22px,2.2vw,30px);
  text-transform:uppercase;letter-spacing:.5px;user-select:none;line-height:1; /* keeps centered in export */
}

/* Row delete button (replaces old menu) */
.row-del{
  position:absolute;right:8px;bottom:8px;width:34px;height:34px;border-radius:9px;
  background:var(--accent);color:#fff;display:grid;place-items:center;
  box-shadow:0 6px 14px rgba(0,0,0,.35);border:1px solid rgba(255,255,255,.14);font-weight:900;
}
.row-del svg{width:16px;height:16px;fill:currentColor}

/* No more popover/menu styles */

/* Drops */
.tier-drop{
  background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow);
  padding:14px;display:grid;grid-auto-flow:row;grid-template-columns:repeat(auto-fill,minmax(116px,1fr));
  align-content:start;gap:14px;min-height:110px;will-change:transform;
}
.tier-drop:focus-visible{box-shadow:0 0 0 3px rgba(139,125,255,.35),var(--shadow)}
.dropzone.drag-over{box-shadow:0 0 0 3px rgba(139,125,255,.35),var(--shadow)}

/* ---------- Tokens (flat) ---------- */
.token{
  position:relative;width:110px;height:110px;border-radius:999px;overflow:hidden;background:#7da7ff;
  border:none;box-shadow:none;display:flex;align-items:center;justify-content:center;
  user-select:none;cursor:pointer;transform:translateZ(0);transition:transform .08s ease;
}
.token:hover{transform:translateY(-1px)}
.token:active{transform:translateY(0)}
.token:focus-visible{outline:3px solid var(--accent);outline-offset:4px}
.token .label{
  padding:0 14px;text-align:center;font-weight:900;font-size:18px;line-height:1;
  word-break:break-word;hyphens:auto;text-shadow:none;white-space:pre-wrap;
}
.token img{width:100%;height:100%;object-fit:cover;border-radius:999px;pointer-events:none}
.token.selected{outline:3px solid var(--accent);outline-offset:4px}

/* FLIP animation support */
.token.flip-anim{transition:transform 180ms ease}

.drag-ghost{position:fixed;left:0;top:0;z-index:50;pointer-events:none;width:110px;height:110px;border-radius:999px;opacity:.92;transform:translate3d(0,0,0)}
.drag-hidden{opacity:.25}
body.dragging-item{cursor:grabbing;user-select:none;-webkit-user-select:none}
@keyframes pop-in{from{transform:scale(.94)}to{transform:scale(1)}}
.animate-drop{animation:pop-in .18s ease}

/* ---------- Image Storage ---------- */
#tray{
  background:var(--surface-raised);border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow);
  padding:16px;display:grid;grid-template-columns:repeat(auto-fill,minmax(116px,1fr));gap:14px;
}

/* ---------- A11y ---------- */
.sr{position:absolute;width:1px;height:1px;overflow:hidden;clip:rect(0 0 0 0);clip-path:inset(50%);white-space:nowrap}

/* ---------- Radial (mobile) ---------- */
.radial{position:fixed;inset:0;z-index:60;pointer-events:auto;filter:drop-shadow(0 8px 24px rgba(0,0,0,.35))}
.radial.hidden{display:none}
.radial-backdrop{position:absolute;inset:0}
.radial-options{position:relative;width:100%;height:100%}
.radial-option{
  position:absolute;width:42px;height:42px;border-radius:999px;
  display:grid;place-items:center;font-weight:900;font-size:13px;
  background:#fff;color:#111;border:1px solid rgba(0,0,0,.1);
  box-shadow:0 2px 10px rgba(0,0,0,.15);
  transform:translate(-50%,-50%) scale(.94);opacity:0;
  transition:transform .12s ease,opacity .12s ease,box-shadow .12s ease,border-color .12s ease;
}
.radial.visible .radial-option,.radial.show .radial-option{opacity:1;transform:translate(-50%,-50%) scale(1)}
.radial-option.is-hot{border-color:var(--accent);box-shadow:0 4px 14px rgba(0,0,0,.22);transform:translate(-50%,-50%) scale(1.06)}
.radial-highlight{position:absolute;width:1px;height:1px;opacity:0}
.radial-close{
  position:absolute;transform:translate(-50%,-50%);
  width:44px;height:44px;border-radius:999px;border:1px solid var(--border);
  background:var(--surface-raised);color:var(--text);display:grid;place-items:center;box-shadow:0 2px 10px rgba(0,0,0,.25)
}
.radial-close svg{width:22px;height:22px;fill:currentColor}

/* ---------- Utility ---------- */
.hide-on-desktop{display:none}
@media (max-width:768px){.hide-on-desktop{display:initial}}

/* ---------- Print ---------- */
@media print{
  body{background:#fff;color:#000}
  .panel,#tray,.controls,.creator-grid{box-shadow:none;border-color:#ddd}
  .token.selected,.token:focus-visible{outline-color:#000}
}

/* ---------- Reduced motion ---------- */
@media (prefers-reduced-motion:reduce){*{transition:none!important;animation:none!important}}
